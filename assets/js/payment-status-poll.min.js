(p=>{if("undefined"!=typeof wu_payment_poll){let s={paymentHash:wu_payment_poll.payment_hash||"",ajaxUrl:wu_payment_poll.ajax_url||"",pollInterval:parseInt(wu_payment_poll.poll_interval,10)||3e3,maxAttempts:parseInt(wu_payment_poll.max_attempts,10)||20,statusSelector:wu_payment_poll.status_selector||".wu-payment-status",successRedirect:wu_payment_poll.success_redirect||""},t=0,e=null;function a(){++t>s.maxAttempts?(l(),n("timeout")):p.ajax({url:s.ajaxUrl,type:"POST",data:{action:"wu_check_payment_status",payment_hash:s.paymentHash},success:function(e){e.success&&e.data&&("completed"===(e=e.data.status)?(l(),n("completed"),setTimeout(function(){s.successRedirect?window.location.href=s.successRedirect:window.location.reload()},1500)):n("pending"===e?"pending":"checking",t))},error:function(){n("error",t)}})}function n(a){var n=p(s.statusSelector);if(n.length){let e="",t="";switch(a){case"completed":e=wu_payment_poll.messages?.completed||"Payment confirmed! Refreshing page...",t="wu-payment-status-completed";break;case"pending":e=wu_payment_poll.messages?.pending||"Verifying payment...",t="wu-payment-status-pending";break;case"timeout":e=wu_payment_poll.messages?.timeout||"Payment verification timed out. Please refresh the page or contact support if payment was made.",t="wu-payment-status-timeout";break;case"error":e=wu_payment_poll.messages?.error||"Error checking payment status. Retrying...",t="wu-payment-status-error";break;default:e=wu_payment_poll.messages?.checking||"Checking payment status...",t="wu-payment-status-checking"}n.removeClass("wu-payment-status-completed wu-payment-status-pending wu-payment-status-timeout wu-payment-status-error wu-payment-status-checking").addClass(t).html(e)}}function u(){if(s.paymentHash&&s.ajaxUrl){{let e=p(s.statusSelector);var t;e.length||(t=p(".wu-checkout-form, .wu-styling, .entry-content, .post-content, main").first()).length&&(e=p('<div class="wu-payment-status"></div>'),t.prepend(e)),e}n("pending"),e=setInterval(a,s.pollInterval),a()}}function l(){e&&(clearInterval(e),e=null)}p(document).ready(function(){s.paymentHash&&wu_payment_poll.should_poll&&u()}),window.wu_payment_poll_controller={start:u,stop:l,check:a}}})(jQuery);